---
title: "Analisis_exploratorio"
author: "Alejandro Brenes, Santiago Fernández, Eyeri Méndez y Erick Venegas"
date: "`r Sys.Date()`"
output: html_document
---

# Preparación inicial

Inicialmente, descargamos las librarías requeridas.

```{r librarias}
pacman::p_load(astsa,
               dplyr,
               ggplot2,
               lubridate,
               paletteer,
               readr)
```

Posteriormente, se cargan los datos requeridos.

```{r descarga_datos, message = FALSE}
bicicletas <- read_csv("data/bicicletas.csv")
```

Se guarda la paleta de colores utilizada para el desarrollo del proyecto.

```{r paleta_colores}
paleta_colores <- c(
  "#4B1D91",
  "#641896",
  "#84109B",
  "#9B109C",
  "#B0179C",
  "#CB2B97",
  "#E2438A",
  "#EF6276",
  "#F28265",
  "#F2A85F",
  "#EDC375",
  "#E7D39A"
)
```

Algunas correcciones de formato.

```{r formato}
# Se discretiza la variable de días de la semana
bicicletas$weekday <- as.factor(bicicletas$weekday)
levels(bicicletas$weekday) <- c("Dom", "Lun", "Mar", "Mié", "Jue", "Vie", "Sáb")

# Se discretiza la variable del clima
bicicletas$weathersit <- as.factor(bicicletas$weathersit)
levels(bicicletas$weathersit) <- c("Despejado", "Nublado", "Lluvioso/Nevado")
```


# Análisis exploratorio de datos

A través de diversas herramientas, se busca entender el contenido de los datos. Con esto, se pueden evidenciar variables relevantes e interacciones entre los diversos factores de la información disponible.

## Boxplots

En este caso, se analiza el comportamiento de algunas variables a través de boxplots, con la intención de detectar patrones relevantes en las variables de forma individual y al interactuar con otras variables.

```{r boxplots}
# Conteo de bicicletas según día de la semana
ggplot(bicicletas,
       aes(x = weekday, y = cnt, fill = weekday)) +
  geom_boxplot() +
  labs(x = "Día de la semana", y = "Cantidad de bibicletas") +
  theme_minimal() +
  theme(legend.position = "none") +
  scale_fill_manual(values = paleta_colores)

# Conteo de bicicletas casuales según día de la semana
ggplot(bicicletas,
       aes(x = weekday, y = casual, fill = weekday)) +
  geom_boxplot() +
  labs(x = "Día de la semana", y = "Cantidad de bibicletas") +
  theme_minimal() +
  theme(legend.position = "none") +
  scale_fill_manual(values = paleta_colores)

# Conteo de bicicletas registradas según día de la semana
ggplot(bicicletas,
       aes(x = weekday, y = registered, fill = weekday)) +
  geom_boxplot() +
  labs(x = "Día de la semana", y = "Cantidad de bibicletas") +
  theme_minimal() +
  theme(legend.position = "none") +
  scale_fill_manual(values = paleta_colores)

# Conteo de bicicletas según día de la semana
ggplot(bicicletas,
       aes(x = weathersit, y = cnt, fill = weathersit)) +
  geom_boxplot() +
  labs(x = "Clima", y = "Cantidad de bibicletas") +
  theme_minimal() +
  theme(legend.position = "none") +
  scale_fill_manual(values = paleta_colores)

# Conteo de bicicletas casuales según día de la semana
ggplot(bicicletas,
       aes(x = weathersit, y = casual, fill = weathersit)) +
  geom_boxplot() +
  labs(x = "Clima", y = "Cantidad de bibicletas") +
  theme_minimal() +
  theme(legend.position = "none") +
  scale_fill_manual(values = paleta_colores)

# Conteo de bicicletas registradas según día de la semana
ggplot(bicicletas,
       aes(x = weathersit, y = registered, fill = weathersit)) +
  geom_boxplot() +
  labs(x = "Clima", y = "Cantidad de bibicletas") +
  theme_minimal() +
  theme(legend.position = "none") +
  scale_fill_manual(values = paleta_colores)
```


## Series de tiempo

A

## ACF

A

## CCF

A

## Coherencia

A

## Sobredispersión

A

## Periodogramas

Para hacer un análisis de las frecuencias que pueden existir en las diversas variables, se procede con algunos periodogramas.

```{r periodogramas}
# Se grafica el periodograma del conteo de bicicletas
conteo_bicis <- mvspec(
  ts(
    bicicletas$cnt,
    start = c(2011, 1, 1),
    frequency = 365
  ),
  kernel = kernel("modified.daniell", c(3, 3)),
  taper = .1,
  log = "yes",
  main = ""
)
```


